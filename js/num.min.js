var Num=function(b,a){this.initialize.apply(this,arguments)};Num.SCALE_MAX=1000;Num.CHAR_POINT=".";Num.CHAR_COMMA=",";Num.CHAR_CODE_ZERO="0".charCodeAt(0);Num.CHAR_CODE_POINT=Num.CHAR_POINT.charCodeAt(0);Num.ROUND_UP=1;Num.ROUND_DOWN=2;Num.ROUND_CEILING=3;Num.ROUND_FLOOR=4;Num.ROUND_HALF_UP=5;Num.ROUND_HALF_DOWN=6;Num.ROUND_HALF_EVEN=7;Num.DEFAULT_SCALE=32;Num.DEFAULT_ROUND=Num.ROUND_HALF_UP;Num.toNum=function(a){if(a instanceof Num){return a}else{return new Num(a)}};Num.prototype={value:new Array(),integerLen:0,decimalLen:0,minus:false,initialize:function(e,c){if(e==null){return}var f=this._getOptionScale(c);e=String(e);if(!e.match(/^(\+|\-)?\d*\.?\d*$/)){throw new Error(0,"Invalid number:"+e)}var g=0;switch(e.charAt(0)){case"-":this.minus=true;g++;break;case"+":g++;break}this.value=new Array();var b=false;for(var a=e.length;g<a;g++){var d=e.charCodeAt(g);if(d==Num.CHAR_CODE_POINT){b=true}else{this.value.push(d-Num.CHAR_CODE_ZERO);if(b){if(this.decimalLen++==f){break}}else{this.integerLen++}}}this._adjust(c)},abs:function(){var a=this.clone();a.minus=false;return a},add:function(c,b){c=Num.toNum(c);var a;if(!this.minus){if(!c.minus){a=this._addIgnoreSign(c)}else{a=this._subtractIgnoreSign(c)}}else{if(!c.minus){a=c._subtractIgnoreSign(this)}else{a=this._addIgnoreSign(c);a.minus=true}}a._adjust(b);return a},clone:function(b){var a=new Num();a.minus=this.minus;a.integerLen=this.integerLen;a.decimalLen=this.decimalLen;if(b){a.value=this._cloneValue()}else{a.value=this.value}return a},compareTo:function(a){a=Num.toNum(a);if(!this.minus){if(!a.minus){return this._compareToIgnoreSign(a)}else{return 1}}else{if(!a.minus){return -1}else{return a._compareToIgnoreSign(this)}}},divide:function(b,a){return this._divide(b,false,a)},divideAndRemainder:function(a){return this._divide(a,true,{})},equals:function(b){b=Num.toNum(b);if(this.minus==b.minus&&this.integerLen==b.integerLen&&this.decimalLen==b.decimalLen){for(var a=0;a<this.value.length;a++){if(this.value[a]!=b.value[a]){return false}}return true}return false},max:function(a){a=Num.toNum(a);if(this.compareTo(a)<0){return a}else{return this}},min:function(a){a=Num.toNum(a);if(this.compareTo(a)>0){return a}else{return this}},modulo:function(a){return this._divide(a,true,{})[1]},multiply:function(e,g){e=Num.toNum(e);var l=new Num();l.value=new Array();var d=this.value.length;var b=e.value.length;var h=d+b;for(var f=0;f<h;f++){l.value[f]=0}for(var f=0;f<d;f++){var a=this.value[this.value.length-f-1];for(var c=0;c<b;c++){l.value[h-f-c-1]+=a*e.value[e.value.length-c-1]}}for(var f=h-1;f>0;f--){var m=l.value[f];var k=m%10;l.value[f]=k;if(m>=10){l.value[f-1]+=(m-k)/10}}l.decimalLen=this.decimalLen+e.decimalLen;l.integerLen=l.value.length-l.decimalLen;l.minus=(this.minus&&!e.minus)||(!this.minus&&e.minus);l._adjust(g);return l},negate:function(){if(this.value.length>0){var a=this.clone();a.minus=!a.minus;return a}else{return this}},power:function(f,d){f=Num.toNum(f);var e=false;if(f.signum()==-1){f=f.negate();e=true}if(f.decimalLen>0){throw new Error(0,"unsupport decimal")}var g="";while(!f.equals(Num.ZERO)){var a=f.divideAndRemainder(2);f=a[0];g=Math.abs(a[1].toNumber())+g}var a=Num.ONE;for(var c=0,b=g.length;c<b;c++){a=a.multiply(a);if(g.charAt(c)=="1"){if(e){a=a.divide(this)}else{a=a.multiply(this)}}}a._adjust(d);return a},round:function(b){var a=this.clone(true);a._adjust(b);return a},signum:function(){return this.minus?-1:1},subtract:function(c,b){c=Num.toNum(c);var a;if(!this.minus){if(!c.minus){a=this._subtractIgnoreSign(c)}else{a=this._addIgnoreSign(c)}}else{if(!c.minus){a=this._addIgnoreSign(c);a.minus=true}else{a=c._subtractIgnoreSign(this)}}a._adjust(b);return a},toNumber:function(){return Number(this.toString())},toString:function(d){var h=this._getOptionComma(d);var a=this._getOptionAutoDecimal(d);var e=this;var a=this._getOptionAutoDecimal(d);if(this._isOptionExists(d,"scale")||this._isOptionExists(d,"round")||a!=null){var b;if(this._isOptionExists(d,"scale")){b=this._getOptionScale(d)}else{b=Num.SCALE_MAX}if(a!=null){for(var c=e.integerLen;c<e.value.length;c++){var f=e.value[c];if(f!=0){if(b>c-e.integerLen+a){b=c-e.integerLen+a}break}}}e=this.round({scale:b,round:this._getOptionRound(d)})}var c=0;var j=e.minus?"-":"";if(e.integerLen==0){j+="0"}else{for(var g=e.integerLen-1;c<e.integerLen;c++,g--){j+=e.value[c];if(g%h==0&&g!=0){j+=Num.CHAR_COMMA}}}if(e.decimalLen>0){j+=Num.CHAR_POINT;for(;c<e.value.length;c++){j+=e.value[c]}}return j},_addIgnoreSign:function(g){var a=new Num();a.value=new Array();var f=0;var b=Math.max(this.decimalLen,g.decimalLen);var d=Math.max(this.integerLen,g.integerLen);for(var c=-b;c<d;c++){var e=this._getFigure(c)+g._getFigure(c)+f;var h;if(e>=10){h=e%10;f=1}else{h=e;f=0}a.value.unshift(h)}a.decimalLen=b;a.integerLen=d;if(f>0){a.value.unshift(f);a.integerLen++}return a},_adjust:function(d){var b=this._getOptionScale(d);var j=this._getOptionRound(d);if(b<this.decimalLen){var e=this.value[this.integerLen+b];var f=false;switch(j){case Num.ROUND_UP:if(e!=0){f=true}break;case Num.ROUND_DOWN:break;case Num.ROUND_CEILING:if(e!=0&&!this.minus){f=true}break;case Num.ROUND_FLOOR:if(e!=0&&this.minus){f=true}break;case Num.ROUND_HALF_UP:if(e>=5){f=true}break;case Num.ROUND_HALF_DOWN:if(e>5){f=true}break;case Num.ROUND_HALF_EVEN:var a;if(this.integerLen+b-1>=0){a=this.value[this.integerLen+b-1]}else{a=0}if(a%2==1){if(e>=5){f=true}}else{if(e>5){f=true}}}if(f){var h=1;for(var c=this.integerLen+b-1;c>=0;c--){var g=this.value[c]+h;var e=g%10;this.value[c]=e;if(g>=10){carray=1}else{h=0;break}}if(h){this.value.unshift(h);this.integerLen++}}this.value.length-=this.decimalLen-b;this.decimalLen=b}while(this.decimalLen>0&&this.value[this.value.length-1]==0){this.value.pop();this.decimalLen--}while(this.integerLen>0&&this.value[0]==0){this.value.shift();this.integerLen--}if(this.value.length==0){this.minus=false}},_cloneValue:function(){var a=new Array();for(var c=0,b=this.value.length;c<b;c++){a[c]=this.value[c]}return a},_compareToIgnoreSign:function(c){if(this.integerLen<c.integerLen){return -1}if(this.integerLen>c.integerLen){return 1}var b=Math.min(this.value.length,c.value.length);for(var a=0;a<b;a++){if(this.value[a]<c.value[a]){return -1}else{if(this.value[a]>c.value[a]){return 1}}}if(this.value.length<c.value.length){return -1}else{if(this.value.length>c.value.length){return 1}else{return 0}}},_divide:function(e,w,f){e=Num.toNum(e);if(e.value.length==0){throw new Error(0,"Devide by zero")}var y;if(w){y=-1}else{y=this._getOptionScale(f)}var d=new Num();d.value=new Array();var m=this._cloneValue();var c;for(c=0;c<e.value.length&&e.value[c]==0;c++){}var a=e.value.length-c;var b=e.integerLen-this.integerLen-c;for(var q=0,v=y-b+1;q<=v;q++){for(var n=0;n<10;n++){var p=true;for(var o=0,l=a;o<l;o++){var u;if(o<m.length){u=m[o]}else{u=0}var s=e.value[o+c];if(u>s){break}else{if(u<s){p=false;break}}}if(!p){if(m.length>0&&q!=v){if(m[1]==null){m[1]=m[0]*10}else{m[1]+=m[0]*10}m.shift()}break}else{var r=0;for(var o=a-1;o>=0;o--){var u=m[o];if(u==null){u=0}var s=e.value[o+c];var h=u-s-r;if(h<0){r=1;h+=10}else{r=0}m[o]=h}}}d.value[q]=n==10?0:n;var g=true;for(var o=0,l=m.length;o<l;o++){if(m[o]!=0){g=false;break}}if(g){break}}d.minus=(this.minus&&!e.minus)||(!this.minus&&e.minus);if(b<=0){while(d.value.length<=-b){d.value.push(0)}d.integerLen=1-b}else{for(var q=1;q<b;q++){d.value.unshift(0)}d.integerLen=0}d.decimalLen=d.value.length-d.integerLen;d._adjust(f);if(w){var t=new Num();t.minus=this.minus;t.value=m;t.integerLen=Math.min(e.integerLen,this.integerLen);t.decimalLen=t.value.length-t.integerLen;t._adjust({scale:Num.MAX_SCALE});return new Array(d,t)}else{return d}},_getFigure:function(a){var b=this.integerLen-a-1;if(b<0||this.value.length<=b){return 0}else{return this.value[b]}},_getOptionScale:function(a){var b=this._getOption(a,"scale",Num.DEFAULT_SCALE);if(b<0||Num.SCALE_MAX<b){throw new Error(0,"Invalid scale:"+b)}return b},_getOptionRound:function(b){var a=this._getOption(b,"round",Num.DEFAULT_ROUND);if(a<Num.ROUND_UP||Num.ROUND_HALF_EVEN<a){throw new Error(0,"Invalid round:"+a)}return a},_getOptionComma:function(b){var a=this._getOption(b,"comma",0);if(a<0){throw new Error(0,"Invalid comma:"+a)}return a},_getOptionAutoDecimal:function(b){var a=this._getOption(b,"autoDecimal",null);if(a!=null&&a<0){throw new Error(0,"Invalid autoDecimal:"+a)}return a},_getOption:function(c,b,a){var d=a;if(c!=null){if(c[b]!=null){d=c[b]}}return d},_isOptionExists:function(b,a){if(b!=null){if(b[a]!=null){return true}}return false},_subtractIgnoreSign:function(a){var d=this._compareToIgnoreSign(a);if(d==0){return new Num()}if(d<0){var g=a._subtractIgnoreSign(this);if(g.value.length>0){g.minus=true}return g}var g=new Num();g.value=new Array();var j=0;var e=Math.max(this.decimalLen,a.decimalLen);var c=Math.max(this.integerLen,a.integerLen);for(var b=-e;b<c;b++){var h=this._getFigure(b)-a._getFigure(b)-j;var f;if(h>=0){f=h;j=0}else{f=10+h;j=1}g.value.unshift(f)}g.decimalLen=e;g.integerLen=c;return g}};Num.ZERO=new Num(0);Num.ONE=new Num(1);